(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{fbc9:function(t,e,r){"use strict";var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-dialog",{ref:"dialog",on:{hide:t.onDialogHide}},[r("q-card",{staticClass:"q-dialog-plugin bg-accent q-pa-md",staticStyle:{"max-width":"1500px","max-height":"1000px",width:"1000px",height:"650px"}},[r("div",{staticClass:"row q-pa-md bg-dark text-white"},[r("div",{staticClass:"col-4"},[t._v("訂單號碼： "+t._s(t.orders._id))]),r("div",{staticClass:"col-4"},[t._v("訂購日期： "+t._s(new Date(t.orders.date).toLocaleString("zh-tw")))]),r("div",{staticClass:"col-4"},[t._v("\n        訂單狀態： "+t._s(t.orders.orderStatus)+"\n      ")])]),r("div",{staticClass:"row bg-primary text-white q-py-md"},[r("div",{staticClass:"col-3",attrs:{align:"center"}},[t._v("商品圖片")]),r("div",{staticClass:"col-3",attrs:{align:"center"}},[t._v("商品名稱")]),r("div",{staticClass:"col-3",attrs:{align:"center"}},[t._v("數量")]),r("div",{staticClass:"col-3",attrs:{align:"center"}},[t._v("價格")])]),t._l(t.orders.products,(function(e){return r("div",{key:e.id,staticClass:"row items-center q-pa-md bg-white"},[r("div",{staticClass:"col-3",attrs:{align:"center"}},[r("img",{staticClass:"text-center",staticStyle:{width:"100px","max-height":"100px"},attrs:{src:e.product.productImage}})]),r("div",{staticClass:"col-3",attrs:{align:"center"}},[t._v(t._s(e.product.productName))]),r("div",{staticClass:"col-3",attrs:{align:"center"}},[t._v(t._s(e.quantity))]),r("div",{staticClass:"col-3",attrs:{align:"center"}},[t._v(t._s(e.product.productPrice))])])})),r("div",{staticClass:"row q-pa-md bg-primary text-white"},[r("div",{staticClass:"col-12"},[t._v("\n        寄送方式："+t._s(t.orders.order.delivery)+"\n      ")])]),r("div",{staticClass:"row q-pa-md bg-white"},[r("div",{staticClass:"col-2"},[r("div",[t._v("\n          寄件人姓名：\n        ")]),r("div",[t._v("\n          手機號碼：\n        ")]),r("div",[t._v("\n          email：\n        ")]),r("div",[t._v("\n          寄送地址：\n        ")]),r("div",[t._v("\n          備註：\n        ")])]),r("div",{staticClass:"col-10 text-dark"},[r("div",[t._v("\n          "+t._s(t.orders.order.recipient)+"\n        ")]),r("div",[t._v("\n          "+t._s(t.orders.order.mobile)+"\n        ")]),r("div",[t._v("\n          "+t._s(t.orders.order.mobile)+"\n        ")]),r("div",[t._v("\n          "+t._s(t.orders.order.address)+"\n        ")]),r("div",[t._v("\n          "+t._s(t.orders.order.remark)+"\n        ")])])]),r("div",{staticClass:"row q-pa-md bg-primary text-white"},[r("div",{staticClass:"col-6"},[t._v("\n        付款方式："+t._s(t.orders.order.pay)+"\n      ")]),r("div",{staticClass:"col-6"},[t._v("\n        發票寄送方式："+t._s(t.orders.order.receiptCarrier)+"\n      ")])]),r("div",{staticClass:"row q-pa-md text-dark bg-white"},[r("div",{staticClass:"col-6"}),"手機條碼"===t.orders.order.receiptCarrier?r("div",{staticClass:"col-6"},[t._v("\n        手機條碼："+t._s(t.orders.order.code)+"\n      ")]):t._e()]),r("q-card-actions",{staticClass:"q-pa-md",attrs:{align:"center"}},[r("q-btn",{attrs:{color:"primary",label:"關閉"},on:{click:t.hide}})],1)],2)],1)},a=[],i={props:{orderInfo:{type:Object}},data(){return{orders:{}}},methods:{onRejected(t){this.$q.notify({type:"negative",message:`${t.length} file(s) did not pass validation constraints`})},show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide()},onDialogHide(){this.$emit("hide")}},computed:{},async created(){this.orders=this.orderInfo}},o=i,d=r("2877"),n=r("24e8"),l=r("f09f"),c=r("4b7e"),p=r("9c40"),v=r("eebe"),u=r.n(v),_=Object(d["a"])(o,s,a,!1,null,"6680bf4e",null);e["a"]=_.exports;u()(_,"components",{QDialog:n["a"],QCard:l["a"],QCardActions:c["a"],QBtn:p["a"]})},fde2:function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"q-pa-xl bg-white"},[r("q-table",{ref:"table",attrs:{title:"我的訂單",data:t.orders,columns:t.columns,"row-key":"name"},scopedSlots:t._u([{key:"body",fn:function(e){return[r("q-tr",{attrs:{props:e}},[r("q-td",{key:"orderId",attrs:{props:e}},[t._v(t._s(e.row._id))]),r("q-td",{key:"orderDate",attrs:{props:e}},[t._v(t._s(new Date(e.row.date).toLocaleString("zh-tw")))]),r("q-td",{key:"orderProducts",attrs:{props:e}},[r("ul",t._l(e.row.products,(function(e){return r("li",{key:e._id},[t._v("\n                "+t._s(e.product.productName)+" x "+t._s(e.quantity)+"\n              ")])})),0)]),r("q-td",{key:"orderPrice",attrs:{props:e}},[t._v("\n            "+t._s(t.total(e.row))+"\n          ")]),r("q-td",{key:"orderStatus",attrs:{props:e}},[t._v("\n            "+t._s(e.row.orderStatus)+"\n          ")]),r("q-td",{key:"productDescription",attrs:{props:e}},[t._v(t._s(e.row.productDescription))]),r("q-td",{key:"quantitySold",attrs:{props:e}},[t._v(t._s(e.row.quantitySold))]),r("q-td",{key:"editOrDelete"},[r("div",{staticClass:"row",attrs:{align:"center"}},[r("div",{staticClass:"col-12 q-gutter-x-md"},[r("q-btn",{staticClass:"bg-white bubble",attrs:{size:"0.7rem"},on:{click:function(r){return t.orderInfo(e.pageIndex)}}},[t._v("查看詳細")]),r("q-btn",{staticClass:"bg-white bubble",attrs:{size:"0.7rem"},on:{click:function(r){return t.cancelOrders(e.row._id,e.row.order)}}},[t._v("取消訂單")])],1)])])],1)]}}])})],1)},a=[],i=r("fbc9");const o=[{name:"orderId",required:!0,label:"訂單編號",align:"left",field:t=>t.orderId,format:t=>`${t}`},{name:"orderDate",align:"left",label:"訂購日期",field:"orderDate"},{name:"orderProducts",align:"left",label:"訂購產品",field:"orderProducts"},{name:"orderPrice",align:"left",label:"總金額",field:"orderPrice"},{name:"orderStatus",align:"center",label:"訂單狀態",field:"orderStatus"},{name:"editOrDelete",align:"center",label:"操作",field:"editOrDelete"}];var d={data(){return{columns:o,orders:[]}},methods:{orderInfo(t){this.order={...this.orders[t]},console.log(this.order),this.$q.dialog({title:"",component:i["a"],parent:this,orderInfo:this.order}).onOk((()=>{console.log("OK")})).onCancel((()=>{console.log("Cancel")})).onDismiss((()=>{console.log("Called on OK or Cancel")}))},total(t){return t.products.reduce(((t,e)=>t+e.quantity*e.product.productPrice),0)},async cancelOrders(t,e){console.log(t);const r={orderStatus:"已取消"};try{await this.api.patch("/Orders/"+t,r,{headers:{authorization:"Bearer "+this.$store.getters["user/user"].token}}),this.$q.dialog({parent:this,title:"成功",message:"取消訂單成功"}).onOk((()=>{})).onCancel((()=>{})).onDismiss((()=>{}))}catch(s){console.log(s),this.$q.dialog({parent:this,title:"取消失敗",message:s.response.data.message}).onOk((()=>{})).onCancel((()=>{})).onDismiss((()=>{}))}}},async created(){try{const{data:t}=await this.api.get("/orders/me",{headers:{authorization:"Bearer "+this.$store.getters["user/user"].token}});this.orders=t.result}catch(t){console.log(t),this.$q.dialog({parent:this,title:"錯誤",message:"取得訂單失敗"}).onOk((()=>{})).onCancel((()=>{})).onDismiss((()=>{}))}}},n=d,l=r("2877"),c=r("eaac"),p=r("bd08"),v=r("db86"),u=r("9c40"),_=r("eebe"),g=r.n(_),h=Object(l["a"])(n,s,a,!1,null,"0d6ec928",null);e["default"]=h.exports;g()(h,"components",{QTable:c["a"],QTr:p["a"],QTd:v["a"],QBtn:u["a"]})}}]);